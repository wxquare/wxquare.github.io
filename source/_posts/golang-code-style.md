---
title: Golang命名和编码规范
categories:
- Golang
---

## 1.工具
- godoc
- gofmt
- goimport
- go vet
- golint


## 2.命名
- **工程名服务名**
- **目录与包名**：包名与目录名相同，包名应该为小写单词，不要使用下划线或者混合大小写，建议使用比较短的名词短语，例如l5、util、log、kafka、ppMonitor、dao、wsd等
- **文件名**：简短有意义的小写单词，使用下划线分割各个单词
- **结构体命名**： 驼峰命名法，首字母根据访问控制控制大小写
- **接口命名**： 类似结构体
- **变量命名**： 与结构体驼峰样式相同，遇到特有名词缩写时应同为全部大写或者小写字母。例如apiClient，UserID，URLArray。若变量为bool类型时，则名称应以Has、Is、Can开头。
- **常量命名**： 大写单词加下划线连接
- **函数**： 函数采用命名的多值返回，传入变量和返回变量以小写字母开头。因为在godoc生成文档中，带有返回值的函数申明更利于理解。

## 3.import规范
- 对import的包进行分组管理，分别为标准库、程序内部包、第三方包
- 项目中不要使用相对路径引入包，而使用绝对路径 


## 4.错误处理
- 函数返回error是好习惯，使用多返回值 error， 不要使用 c 风格，返回错误码
- 调用函数时，必须首先对函数可能的错误进行处理
- 尽早判断和处理错误
- 尽量不要使用panic，只有在文件无法打开，数据库无法连接导致程序无法正常运行等特殊情况才考虑使用panic。


## 5.测试
- golang提供了非常好的单元测试工具，在提交代码之前，针对重要的代码需要一些单元测试
- 单元测试文件名example_test.go,测试用例的函数必须以Test开头，例如TestExample


## 6.注释与godoc
  除了标注某些变量的含义，注释尽可能使用完整的句子       
- 包注释  尽量使用//
- 文件注释:包含作者，创建时间和简单功能描述   
- 关键类和对象注释  
- 关键函数注释  
- 关键变量含义注释

## 7.函数
- 为了便于生成清晰点的文档，函数尽量采用命名的多值返回
- 传入的变量和返回的变量以小写字母开头
- 对于少量数据，尽量不要使用指针，对于大量的struct可以考虑指针
- 对于传入参数是map、slice、chan不要传递指针，因为map、slice、chan是引用类型


## 8.defer的使用和坑
- golang中的defer在函数返回之前使用，但是使用的时候有一些坑需要注意。
```
	package main

	import (
		"fmt"
	)

	func f() (ret int) {
		defer func() {
			ret++
		}()
		return 0
	}

	func f2() (ret int) {
		r := 5
		defer func() {
			r = r + 5
		}()
		return r
	}

	func f3() (r int) {
		defer func(r int) {
			r = r + 5
		}(r)
		return 1
	}

	func f4() (r int) {
		defer func(r *int) {
			*r = *r + 5
		}(&r)
		return 1
	}

	func main() {
		fmt.Println(f())
		fmt.Println(f2())
		fmt.Println(f3())
		fmt.Println(f4())
	}

```



## 9.方法接收器
- 方法接收器的名称一般采用struct的第一个或者两个字母的小写形式。不要使用this、me或者self
- 指针类型接收器和非指针类型接收器
- 如果接受者是map、slice或者chan，不要用指针传递
- 如果slice等进行修改可通过返回值重新赋值
- 如果接受者是含有sync.Mutex或者类似同步字段结构体，必须使用指针传递避免复制
- 如果接收者是大的结构体或者数组，使用指针传递。
 


## 10.其它约定
- 文件长度最好不要超过500行，每行最好不超过80字符
- 多返回值最多返回三个，超过三个请使用 struct
- golang的内置类型slice，map，chan都是引用，初次使用前，必须先用make分配好对象，不然会有空指针异常
- 尽量少用命名多返回值，如果要用，必须显示 return结果

