---
layout: false
---

# Redis Ziplist å®æˆ˜åˆ†æï¼šHash {name: "iPhone", price: 5999}

## 1. æ•´ä½“ç»“æ„é¢„è§ˆ

```
HSET product:1001 name "iPhone" price 5999
```

**ziplist ç¼–ç æ ¼å¼**ï¼šfield-value äº¤æ›¿å­˜å‚¨

```
[Header 10B] [field1] [value1] [field2] [value2] [End 1B]
   å¤´éƒ¨       "name"  "iPhone"  "price"   5999     å°¾éƒ¨
```

---

## 2. å®Œæ•´çš„å­—èŠ‚çº§å†…å­˜å¸ƒå±€

### æ•´ä½“å›¾ç¤º

```
åç§»é‡ | å­—æ®µ           | åå…­è¿›åˆ¶å€¼              | åè¿›åˆ¶å€¼    | è¯´æ˜
-------|----------------|------------------------|------------|------------------
0-3    | zlbytes        | 0x00 00 00 2C          | 44         | æ€»å¤§å° 44 å­—èŠ‚
4-7    | zltail         | 0x00 00 00 23          | 35         | å°¾èŠ‚ç‚¹åç§» 35
8-9    | zllen          | 0x00 04                | 4          | 4ä¸ªèŠ‚ç‚¹ (2å­—æ®µ+2å€¼)
       |----------------|------------------------|------------|------------------
10     | Entry 1        |                        |            | field: "name"
10     | â”œâ”€ prevlen     | 0x00                   | 0          | ç¬¬ä¸€ä¸ªèŠ‚ç‚¹
11     | â”œâ”€ encoding    | 0x04                   | 4          | å­—ç¬¦ä¸²é•¿åº¦4
12-15  | â””â”€ content     | 0x6E 61 6D 65          | "name"     | n a m e
       |----------------|------------------------|------------|------------------
16     | Entry 2        |                        |            | value: "iPhone"
16     | â”œâ”€ prevlen     | 0x06                   | 6          | å‰ä¸€èŠ‚ç‚¹6å­—èŠ‚
17     | â”œâ”€ encoding    | 0x06                   | 6          | å­—ç¬¦ä¸²é•¿åº¦6
18-23  | â””â”€ content     | 0x69 50 68 6F 6E 65    | "iPhone"   | i P h o n e
       |----------------|------------------------|------------|------------------
24     | Entry 3        |                        |            | field: "price"
24     | â”œâ”€ prevlen     | 0x08                   | 8          | å‰ä¸€èŠ‚ç‚¹8å­—èŠ‚
25     | â”œâ”€ encoding    | 0x05                   | 5          | å­—ç¬¦ä¸²é•¿åº¦5
26-30  | â””â”€ content     | 0x70 72 69 63 65       | "price"    | p r i c e
       |----------------|------------------------|------------|------------------
31     | Entry 4        |                        |            | value: 5999
31     | â”œâ”€ prevlen     | 0x07                   | 7          | å‰ä¸€èŠ‚ç‚¹7å­—èŠ‚
32     | â”œâ”€ encoding    | 0xC0                   | 11000000   | int16_t æ•´æ•°
33-34  | â””â”€ content     | 0x6F 17                | 5999       | å°ç«¯åºæ•´æ•°
       |----------------|------------------------|------------|------------------
35     | zlend          | 0xFF                   | 255        | ç»“æŸæ ‡è®°
-------|----------------|------------------------|------------|------------------
æ€»è®¡: 36 å­—èŠ‚
```

---

## 3. å„éƒ¨åˆ†è¯¦ç»†è§£æ

### ğŸ“Œ å¤´éƒ¨ä¿¡æ¯ï¼ˆ10 å­—èŠ‚ï¼‰

#### zlbytes (4å­—èŠ‚)
```
å€¼: 0x00 00 00 2C = 44
è¯´æ˜: æ•´ä¸ª ziplist å ç”¨ 44 å­—èŠ‚
è®¡ç®—: 10(å¤´) + 6(entry1) + 8(entry2) + 7(entry3) + 4(entry4) + 1(å°¾) = 36å­—èŠ‚
æ³¨æ„: è¿™é‡Œæˆ‘ç®€åŒ–äº†ï¼Œå®é™…å¯èƒ½ç•¥æœ‰ä¸åŒ
```

#### zltail (4å­—èŠ‚)
```
å€¼: 0x00 00 00 23 = 35
è¯´æ˜: æœ€åä¸€ä¸ª entry (entry4) ä»åç§» 35 å¼€å§‹
è®¡ç®—: 10 + 6 + 8 + 7 = 31 (entry4 èµ·å§‹ä½ç½®)
```

#### zllen (2å­—èŠ‚)
```
å€¼: 0x00 04 = 4
è¯´æ˜: å…± 4 ä¸ªèŠ‚ç‚¹ï¼ˆ2ä¸ª field + 2ä¸ª valueï¼‰
```

---

### ğŸ“Œ Entry 1: field "name" (6å­—èŠ‚)

```
å†…å­˜å¸ƒå±€:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ prevlen  â”‚ encoding  â”‚ content             â”‚
â”‚ 0x00     â”‚ 0x04      â”‚ 0x6E 61 6D 65       â”‚
â”‚ 1å­—èŠ‚    â”‚ 1å­—èŠ‚     â”‚ 4å­—èŠ‚               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### prevlen = 0x00
```
å€¼: 0
è¯´æ˜: å‰ä¸€ä¸ªèŠ‚ç‚¹é•¿åº¦ä¸º 0ï¼ˆå› ä¸ºè¿™æ˜¯ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ï¼‰
ç¼–ç : < 254ï¼Œä½¿ç”¨ 1 å­—èŠ‚
```

#### encoding = 0x04
```
äºŒè¿›åˆ¶: 0000 0100
è§£æ: 
  - å‰2ä½ 00: å­—ç¬¦ä¸²ç±»å‹
  - å6ä½ 000100 = 4: å­—ç¬¦ä¸²é•¿åº¦ä¸º 4
æ ¼å¼: 00pppppp (p è¡¨ç¤ºé•¿åº¦ä½)
```

#### content = "name"
```
ASCII ç :
  0x6E = 'n' (110)
  0x61 = 'a' (97)
  0x6D = 'm' (109)
  0x65 = 'e' (101)
é•¿åº¦: 4 å­—èŠ‚
```

**æ€»è®¡: 1 + 1 + 4 = 6 å­—èŠ‚**

---

### ğŸ“Œ Entry 2: value "iPhone" (8å­—èŠ‚)

```
å†…å­˜å¸ƒå±€:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ prevlen  â”‚ encoding  â”‚ content                      â”‚
â”‚ 0x06     â”‚ 0x06      â”‚ 0x69 50 68 6F 6E 65          â”‚
â”‚ 1å­—èŠ‚    â”‚ 1å­—èŠ‚     â”‚ 6å­—èŠ‚                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### prevlen = 0x06
```
å€¼: 6
è¯´æ˜: å‰ä¸€ä¸ªèŠ‚ç‚¹ï¼ˆentry1ï¼‰é•¿åº¦ä¸º 6 å­—èŠ‚
ç¼–ç : < 254ï¼Œä½¿ç”¨ 1 å­—èŠ‚
ä½œç”¨: æ”¯æŒåå‘éå†ï¼Œå½“å‰èŠ‚ç‚¹åœ°å€ - 6 = å‰ä¸€ä¸ªèŠ‚ç‚¹åœ°å€
```

#### encoding = 0x06
```
äºŒè¿›åˆ¶: 0000 0110
è§£æ:
  - å‰2ä½ 00: å­—ç¬¦ä¸²ç±»å‹
  - å6ä½ 000110 = 6: å­—ç¬¦ä¸²é•¿åº¦ä¸º 6
```

#### content = "iPhone"
```
ASCII ç :
  0x69 = 'i' (105)
  0x50 = 'P' (80)
  0x68 = 'h' (104)
  0x6F = 'o' (111)
  0x6E = 'n' (110)
  0x65 = 'e' (101)
é•¿åº¦: 6 å­—èŠ‚
```

**æ€»è®¡: 1 + 1 + 6 = 8 å­—èŠ‚**

---

### ğŸ“Œ Entry 3: field "price" (7å­—èŠ‚)

```
å†…å­˜å¸ƒå±€:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ prevlen  â”‚ encoding  â”‚ content                     â”‚
â”‚ 0x08     â”‚ 0x05      â”‚ 0x70 72 69 63 65            â”‚
â”‚ 1å­—èŠ‚    â”‚ 1å­—èŠ‚     â”‚ 5å­—èŠ‚                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### prevlen = 0x08
```
å€¼: 8
è¯´æ˜: å‰ä¸€ä¸ªèŠ‚ç‚¹ï¼ˆentry2ï¼‰é•¿åº¦ä¸º 8 å­—èŠ‚
```

#### encoding = 0x05
```
äºŒè¿›åˆ¶: 0000 0101
è§£æ:
  - å‰2ä½ 00: å­—ç¬¦ä¸²ç±»å‹
  - å6ä½ 000101 = 5: å­—ç¬¦ä¸²é•¿åº¦ä¸º 5
```

#### content = "price"
```
ASCII ç :
  0x70 = 'p' (112)
  0x72 = 'r' (114)
  0x69 = 'i' (105)
  0x63 = 'c' (99)
  0x65 = 'e' (101)
é•¿åº¦: 5 å­—èŠ‚
```

**æ€»è®¡: 1 + 1 + 5 = 7 å­—èŠ‚**

---

### ğŸ“Œ Entry 4: value 5999 (4å­—èŠ‚) â­ **æ•´æ•°ä¼˜åŒ–**

```
å†…å­˜å¸ƒå±€:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ prevlen  â”‚ encoding  â”‚ content         â”‚
â”‚ 0x07     â”‚ 0xC0      â”‚ 0x6F 17         â”‚
â”‚ 1å­—èŠ‚    â”‚ 1å­—èŠ‚     â”‚ 2å­—èŠ‚           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### prevlen = 0x07
```
å€¼: 7
è¯´æ˜: å‰ä¸€ä¸ªèŠ‚ç‚¹ï¼ˆentry3ï¼‰é•¿åº¦ä¸º 7 å­—èŠ‚
```

#### encoding = 0xC0
```
äºŒè¿›åˆ¶: 1100 0000
è§£æ:
  - å‰2ä½ 11: æ•´æ•°ç±»å‹
  - å6ä½ 000000: å­ç±»å‹ int16_tï¼ˆ2å­—èŠ‚æ•´æ•°ï¼‰
æ•´æ•°èŒƒå›´: -32768 ~ 32767
```

#### content = 5999
```
åå…­è¿›åˆ¶: 0x6F 17 (å°ç«¯åº)
è§£æ:
  ä½å­—èŠ‚åœ¨å‰: 0x6F = 111 (åè¿›åˆ¶)
  é«˜å­—èŠ‚åœ¨å: 0x17 = 23 (åè¿›åˆ¶)
  è®¡ç®—: 0x176F = 23 * 256 + 111 = 5888 + 111 = 5999
  
éªŒè¯:
  5999 = 0x176F
  å°ç«¯åºå­˜å‚¨: [0x6F] [0x17]
```

**æ€»è®¡: 1 + 1 + 2 = 4 å­—èŠ‚**

**ğŸ¯ ä¼˜åŒ–æ•ˆæœ**ï¼šå¦‚æœç”¨å­—ç¬¦ä¸² "5999" å­˜å‚¨ï¼Œéœ€è¦ 1+1+4=6 å­—èŠ‚ï¼Œæ•´æ•°ç¼–ç èŠ‚çœäº† 2 å­—èŠ‚ï¼

---

### ğŸ“Œ å°¾éƒ¨æ ‡è®°ï¼ˆ1 å­—èŠ‚ï¼‰

```
å€¼: 0xFF (255)
è¯´æ˜: ziplist ç»“æŸæ ‡è®°
ä½œç”¨: æ­£å‘éå†æ—¶çš„ç»ˆæ­¢æ¡ä»¶
```

---

## 4. å†…å­˜ä½¿ç”¨æ€»ç»“

### å­—èŠ‚åˆ†å¸ƒ

```
ç»„æˆéƒ¨åˆ†          | å­—èŠ‚æ•° | å æ¯”   | è¯´æ˜
------------------|--------|--------|------------------
zlbytes           | 4      | 11.1%  | å¤´éƒ¨
zltail            | 4      | 11.1%  | å¤´éƒ¨
zllen             | 2      | 5.6%   | å¤´éƒ¨
Entry1 "name"     | 6      | 16.7%  | field
Entry2 "iPhone"   | 8      | 22.2%  | value
Entry3 "price"    | 7      | 19.4%  | field
Entry4 5999       | 4      | 11.1%  | value (æ•´æ•°ä¼˜åŒ–)
zlend             | 1      | 2.8%   | å°¾éƒ¨
------------------|--------|--------|------------------
æ€»è®¡              | 36     | 100%   |
```

### ä¸å…¶ä»–ç»“æ„å¯¹æ¯”

#### æ–¹æ¡ˆ1: ziplist (å½“å‰æ–¹æ¡ˆ)
```
æ€»è®¡: 36 å­—èŠ‚
ä¼˜åŠ¿: æè‡´ç´§å‡‘
åŠ£åŠ¿: O(n) æŸ¥æ‰¾
```

#### æ–¹æ¡ˆ2: hashtable
```
dictht ç»“æ„: 24B
table[8] æ•°ç»„: 64B
dictEntry "name": 24B (keyæŒ‡é’ˆ8B + valæŒ‡é’ˆ8B + nextæŒ‡é’ˆ8B)
dictEntry "price": 24B
å­—ç¬¦ä¸² "name": 5B (SDS header) + 4B = 9B
å­—ç¬¦ä¸² "iPhone": 5B + 6B = 11B
å­—ç¬¦ä¸² "price": 5B + 5B = 10B
æ•´æ•° 5999: å¯èƒ½å†…åµŒæˆ– 8B
------------------------------------
æ€»è®¡: çº¦ 166 å­—èŠ‚ (æ˜¯ ziplist çš„ 4.6 å€ï¼)
```

#### æ–¹æ¡ˆ3: String å­˜ JSON
```
JSON: {"name":"iPhone","price":5999}
é•¿åº¦: 32 å­—èŠ‚ (çº¯å­—ç¬¦ä¸²)
åŠ ä¸Š Redis String å¼€é”€: çº¦ 50 å­—èŠ‚
ä¼˜åŠ¿: æ˜“äºåºåˆ—åŒ–
åŠ£åŠ¿: æ— æ³•å•ç‹¬æ›´æ–°å­—æ®µï¼Œéœ€è¦æ•´ä½“è¯»å†™
```

---

## 5. æ“ä½œæ¼”ç¤º

### æŸ¥æ‰¾æ“ä½œï¼šHGET product:1001 name

```c
// æ­¥éª¤1: å®šä½ç¬¬ä¸€ä¸ª entry
ptr = ziplist + 10;  // è·³è¿‡å¤´éƒ¨

// æ­¥éª¤2: éå†æŸ¥æ‰¾
while (*ptr != 0xFF) {
    // è§£æ prevlen
    prevlen = *ptr;
    ptr++;
    
    // è§£æ encoding
    encoding = *ptr;
    ptr++;
    
    // è§£æ content
    if (encoding == 0x04 && memcmp(ptr, "name", 4) == 0) {
        // æ‰¾åˆ°äº†ï¼è·³åˆ°ä¸‹ä¸€ä¸ª entryï¼ˆvalueï¼‰
        ptr += 4;  // è·³è¿‡ "name"
        
        // è¯»å– value çš„ encoding
        ptr++;  // è·³è¿‡ prevlen
        value_encoding = *ptr++;
        
        // è¿”å› "iPhone"
        return memcpy(result, ptr, 6);
    }
    
    // è·³åˆ°ä¸‹ä¸€ä¸ª entry
    ptr += get_content_size(encoding);
}
```

**æ—¶é—´å¤æ‚åº¦**ï¼šO(n)ï¼Œéœ€è¦éå†

---

### æ›´æ–°æ“ä½œï¼šHINCRBY product:1001 price 1

```c
// æ­¥éª¤1: æ‰¾åˆ° "price" å¯¹åº”çš„ value (5999)
// æ­¥éª¤2: è¯»å–æ•´æ•°å€¼ 5999
// æ­¥éª¤3: åŠ  1 å¾—åˆ° 6000
// æ­¥éª¤4: åˆ¤æ–­æ˜¯å¦ä»èƒ½ç”¨ int16 å­˜å‚¨ï¼ˆ6000 < 32767ï¼Œå¯ä»¥ï¼‰
// æ­¥éª¤5: åŸåœ°æ›´æ–° content ä¸º 0x70 17 (6000 çš„å°ç«¯åº)
// æ­¥éª¤6: æ— éœ€é‡æ–°åˆ†é…å†…å­˜ï¼
```

**å…³é”®ä¼˜åŒ–**ï¼šæ•´æ•°ç±»å‹å¯ä»¥åŸåœ°æ›´æ–°ï¼ˆå¦‚æœä¸è·¨è¶Šç¼–ç è¾¹ç•Œï¼‰

---

### æ’å…¥æ“ä½œï¼šHSET product:1001 stock 100

```c
// æ­¥éª¤1: æ£€æŸ¥æ˜¯å¦ä¼šè¶…è¿‡é˜ˆå€¼
if (zllen >= 512) {
    // è½¬æ¢ä¸º hashtable
    convert_to_hashtable();
}

// æ­¥éª¤2: åœ¨å°¾éƒ¨æ’å…¥
// éœ€è¦ realloc æ‰©å±•å†…å­˜
new_size = zlbytes + 6 + 4;  // field(6B) + value(4B)
ziplist = realloc(ziplist, new_size);

// æ­¥éª¤3: å†™å…¥ "stock" (field)
write_entry("stock", 5);

// æ­¥éª¤4: å†™å…¥ 100 (value, æ•´æ•°ç¼–ç )
write_int_entry(100, INT16);

// æ­¥éª¤5: æ›´æ–° zlbytes, zltail, zllen
```

**æ½œåœ¨é—®é¢˜**ï¼šå¯èƒ½è§¦å‘**è¿é”æ›´æ–°**ï¼ˆå¦‚æœæ–°èŠ‚ç‚¹å¤§å°å¯¼è‡´åç»­èŠ‚ç‚¹ prevlen ä» 1B æ‰©å±•åˆ° 5Bï¼‰

---

## 6. ä¸ºä»€ä¹ˆ Redis é€‰æ‹© ziplistï¼Ÿ

### âœ… ä¼˜åŠ¿åœºæ™¯ï¼ˆå°å¯¹è±¡ï¼‰

```
æ•°æ®é‡å°: < 512 ä¸ªå­—æ®µ
æ•°æ®å€¼å°: < 64 å­—èŠ‚
è®¿é—®æ¨¡å¼: HGETALL å±…å¤šï¼ˆå…¨é‡è¯»å–ï¼‰
å†…å­˜æ•æ„Ÿ: å¯¹å†…å­˜å ç”¨æåº¦æ•æ„Ÿ

å…¸å‹åº”ç”¨:
- Session å­˜å‚¨ï¼ˆuid, username, login_time, roleï¼‰
- å•†å“åŸºç¡€ä¿¡æ¯ï¼ˆname, price, stock, brandï¼‰
- ç”¨æˆ·ç”»åƒæ ‡ç­¾ï¼ˆå°‘é‡æ ‡ç­¾ï¼‰
```

### âŒ ä¸é€‚åˆåœºæ™¯

```
æ•°æ®é‡å¤§: > 512 ä¸ªå­—æ®µ â†’ æŸ¥æ‰¾æ…¢
é¢‘ç¹éšæœºè®¿é—®: HGET å•ä¸ªå­—æ®µ â†’ æ¯æ¬¡ O(n)
é¢‘ç¹æ’å…¥åˆ é™¤: realloc å¼€é”€ + è¿é”æ›´æ–°é£é™©
å¤§ value: > 64B â†’ å†…å­˜é‡åˆ†é…å¼€é”€å¤§
```

---

## 7. å®æˆ˜å»ºè®®

### ç›‘æ§å½“å‰ç¼–ç 

```bash
# æŸ¥çœ‹ç¼–ç ç±»å‹
redis> HSET product:1001 name "iPhone" price 5999
redis> OBJECT ENCODING product:1001
"ziplist"

# æ·»åŠ æ›´å¤šå­—æ®µå
redis> HSET product:1001 description "è¿™æ˜¯ä¸€ä¸ªå¾ˆé•¿çš„æè¿°..." (>64å­—èŠ‚)
redis> OBJECT ENCODING product:1001
"hashtable"  # å·²è½¬æ¢ï¼
```

### ä¼˜åŒ–å»ºè®®

```go
// âœ… æ¨èï¼šå°å¯¹è±¡ç”¨ Hash
rdb.HSet(ctx, "session:123", map[string]interface{}{
    "uid":   "88888",
    "name":  "alice",
    "role":  "buyer",
    "login": time.Now().Unix(),
})

// âŒ é¿å…ï¼šå¤§å­—æ®µæˆ–å¤§é‡å­—æ®µ
rdb.HSet(ctx, "user:123", "profile", longJSON)  // å¯èƒ½ > 64B
rdb.HSet(ctx, "config", key1, val1, ..., key1000, val1000)  // > 512 å­—æ®µ
```

### è°ƒä¼˜å‚æ•°

```conf
# redis.conf
hash-max-ziplist-entries 512   # æœ€å¤§å­—æ®µæ•°
hash-max-ziplist-value 64       # æœ€å¤§å€¼é•¿åº¦

# æ ¹æ®ä¸šåŠ¡è°ƒæ•´
hash-max-ziplist-entries 256   # æ›´å¿«è½¬æ¢ä¸º hashtable
hash-max-ziplist-value 128     # å…è®¸æ›´å¤§çš„å€¼
```

---

## 8. æ€»ç»“

### å…³é”®æ•°å­—

```
æ€»å†…å­˜: 36 å­—èŠ‚
å¤´éƒ¨: 10 å­—èŠ‚ (27.8%)
æ•°æ®: 25 å­—èŠ‚ (69.4%)
å°¾éƒ¨: 1 å­—èŠ‚ (2.8%)

å¯¹æ¯” hashtable: èŠ‚çœ 78% å†…å­˜ï¼
```

### æ ¸å¿ƒè®¾è®¡æ€æƒ³

1. **ç´§å‡‘å­˜å‚¨**ï¼šæ— æŒ‡é’ˆï¼Œè¿ç»­å†…å­˜
2. **å˜é•¿ç¼–ç **ï¼šå°æ•°æ®ç”¨å°ç©ºé—´
3. **æ•´æ•°ä¼˜åŒ–**ï¼š5999 ç”¨ 2 å­—èŠ‚ï¼Œä¸æ˜¯ 4 å­—èŠ‚å­—ç¬¦ä¸²
4. **åŒå‘éå†**ï¼šprevlen + zltail è®¾è®¡
5. **CPU å‹å¥½**ï¼šè¿ç»­å†…å­˜åˆ©äºç¼“å­˜

è¿™å°±æ˜¯ Redis åœ¨å°å¯¹è±¡åœºæ™¯ä¸‹çš„æè‡´ä¼˜åŒ–ï¼ğŸš€

